# Super Resolution Using Efficient Sub-Pixel Convolution Neural Network (ESPCN)

* Here I am trying to implement the [Real-Time Single Image and Video Super-Resolution Using an Efficient Sub-Pixel Convolutional Neural Network](https://arxiv.org/abs/1609.05158) paper on medical Brain Tumor Dataset.
* Brain tumor dataset used here is obtained from [figshare](https://figshare.com/articles/dataset/brain_tumor_dataset/1512427). This dataset contains 3064 T1-weighted contrast-enhanced images from 233 patients with three kinds of brain tumor: meningioma (708 slices),  glioma (1426 slices), and pituitary tumor (930 slices) with mask for tumor region. This data is in matlab format and file consists of following fields: -
    * Patient ID
    * Label
    * Image Array
    * Tumor Border (It was generated by manually delineating the tumor border)
    * Tumor Mask
![BT Images](https://github.com/mayank1101/Master-Thesis-Work/blob/main/Presentation/img_feb/img.png?raw=true)
![BT Image Masks](https://github.com/mayank1101/Master-Thesis-Work/blob/main/Presentation/img_feb/mask.png?raw=true)
* From the above images we can clearly see that, we have mask for tumor region, which makes out task easy to separate out tumor region and work on it.
## Network Architecture
![Model](https://github.com/mayank1101/Master-Thesis-Work/blob/main/Implementation%20Work/ESPCN/img/ESPCN%20model.jpeg?raw=true)
* The image we have above, this is how a generally ESPCN model looks like. Here we have added one more extra layer after first layer.
* The network has 3 layers:
    * The input image with shape [B, C, N, N]
    * First layer: convolutional layer with 64 filters and the kernel size of 5 × 5, followed by a tanh activation layer.
    * Second layer: convolutional layer with 64 filters and the kernel size of 3 × 3, followed by a tanh activation layer.
    * Third layer: convolutional layer with 32 filters and the kernel size of 3 × 3, followed by a tanh activation layer.
    * Fourth layer: convolutional layer with the fixed number of output channel C × r × r and the kernel size of 3 × 3.
    * Apply the sub-pixel shuffle function so that the output SR image will have the shape [B, C, r × N, r × N], followed by a sigmoid activation layer. Here it has been achieved using tensorflow nn.depth_to_space method to get final output.
* The network structure of ESPCN can be represented in the above figure. Now, let's see how this works, Suppose there are L layers for the network, the first L-1 layers are convolutional layers which obtain feature maps of the input LR images. And the last layer is the efficient sub-pixel convolutional layer to recover the output image size with a specified upscale factor.
* ![Network](https://github.com/mayank1101/Master-Thesis-Work/blob/main/Implementation%20Work/ESPCN/img/network.jpeg?raw=true)
## Network Flow
![Model Working FLow Chart](https://github.com/mayank1101/Master-Thesis-Work/blob/main/Implementation%20Work/ESPCN/img/ESPCN%20Flow.png?raw=true)

## Results
![Results](https://github.com/mayank1101/Master-Thesis-Work/blob/main/Implementation%20Work/ESPCN/img/espcn_output.png?raw=true)
